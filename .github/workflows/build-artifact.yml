name: Build Puppeteer Artifact

# main ブランチに push されたら実行
on:
  push:
    branches:
      - main

jobs:
  build:
    # GitHub の Ubuntu ランナー上で動く
    runs-on: ubuntu-latest

    steps:
      # リポジトリをチェックアウト
      - uses: actions/checkout@v3

      # 1) 依存インストール
      - name: Install dependencies
        run: npm ci

      # 2) Chromium をダウンロード（puppeteer install）
      - name: Download Chromium
        run: npx puppeteer install

      # 3) node_modules と Puppeteer バイナリをアーティファクト化
      - name: Upload artifact
        uses: actions/upload-artifact@v3
        with:
          name: kenpo-watcher-bundle
          path: |
            node_modules
            .local-chromium
